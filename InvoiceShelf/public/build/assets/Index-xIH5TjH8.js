import{E as se,a7 as le,a8 as oe,M as ne,f as v,v as re,H as ue,k as C,a9 as ce,aa as me,ab as ie,r as o,o as p,m as _,w as t,a,b as i,ac as D,ad as w,l as n,J as b,p as h,t as d,Q as B,K as T,a6 as de}from"./main-gVTYX-GK.js";import{_ as pe}from"./CustomerIndexDropdown-0t2-scue.js";import{_ as _e}from"./AstronautIcon-JuTcujxV.js";const fe={class:"flex items-center justify-end space-x-5"},ye={class:"relative table-container"},he={class:"relative flex items-center justify-end h-5"},Be={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},ve={class:"absolute z-10 items-center left-6 top-2.5 select-none"},Ce={class:"relative block"},Ie={__name:"Index",setup(be){se();const O=le(),u=oe(),g=ne();let k=v(null),f=v(!1),x=v(!0);const{t:m}=re.useI18n();let r=ue({display_name:"",contact_name:"",phone:""});const F=C(()=>!u.totalCustomers&&!x.value),A=C({get:()=>u.selectedCustomers,set:s=>u.selectCustomer(s)}),M=C({get:()=>u.selectAllField,set:s=>u.setSelectAllState(s)}),Y=C(()=>[{key:"status",thClass:"extra w-10 pr-0",sortable:!1,tdClass:"font-medium text-gray-900 pr-0"},{key:"name",label:m("customers.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"phone",label:m("customers.phone")},{key:"due_amount",label:m("customers.amount_due")},{key:"created_at",label:m("items.added_on")},{key:"actions",tdClass:"text-right text-sm font-medium pl-0",thClass:"pl-0",sortable:!1}]);ce(r,()=>{j()},{debounce:500}),me(()=>{u.selectAllField&&u.selectAllCustomers()});function I(){k.value.refresh()}function j(){I()}function z(){return g.hasAbilities([B.DELETE_CUSTOMER,B.EDIT_CUSTOMER,B.VIEW_CUSTOMER])}async function H({page:s,filter:l,sort:y}){let V={display_name:r.display_name,contact_name:r.contact_name,phone:r.phone,orderByField:y.fieldName||"created_at",orderBy:y.order||"desc",page:s};x.value=!0;let c=await u.fetchCustomers(V);return x.value=!1,{data:c.data.data,pagination:{totalPages:c.data.meta.last_page,currentPage:s,totalCount:c.data.meta.total,limit:10}}}function U(){r.display_name="",r.contact_name="",r.phone=""}function L(){f.value&&U(),f.value=!f.value}let P=v(new Date);P.value=ie(P).format("YYYY-MM-DD");function W(){O.openDialog({title:m("general.are_you_sure"),message:m("customers.confirm_delete",2),yesLabel:m("general.ok"),noLabel:m("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(s=>{s&&u.deleteMultipleCustomers().then(l=>{l.data&&I()})})}return(s,l)=>{const y=o("BaseBreadcrumbItem"),V=o("BaseBreadcrumb"),c=o("BaseIcon"),$=o("BaseButton"),G=o("BasePageHeader"),S=o("BaseInput"),E=o("BaseInputGroup"),J=o("BaseFilterWrapper"),K=o("BaseEmptyPlaceholder"),Q=o("BaseDropdownItem"),X=o("BaseDropdown"),R=o("BaseCheckbox"),N=o("BaseText"),q=o("router-link"),Z=o("BaseFormatMoney"),ee=o("BaseTable"),te=o("BasePage");return p(),_(te,null,{default:t(()=>[a(G,{title:s.$t("customers.title")},{actions:t(()=>[i("div",fe,[D(a($,{variant:"primary-outline",onClick:L},{right:t(e=>[n(f)?(p(),_(c,{key:1,name:"XIcon",class:b(e.class)},null,8,["class"])):(p(),_(c,{key:0,name:"FilterIcon",class:b(e.class)},null,8,["class"]))]),default:t(()=>[h(d(s.$t("general.filter"))+" ",1)]),_:1},512),[[w,n(u).totalCustomers]]),n(g).hasAbilities(n(B).CREATE_CUSTOMER)?(p(),_($,{key:0,onClick:l[0]||(l[0]=e=>s.$router.push("customers/create"))},{left:t(e=>[a(c,{name:"PlusIcon",class:b(e.class)},null,8,["class"])]),default:t(()=>[h(" "+d(s.$t("customers.new_customer")),1)]),_:1})):T("",!0)])]),default:t(()=>[a(V,null,{default:t(()=>[a(y,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),a(y,{title:s.$t("customers.customer",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),a(J,{show:n(f),class:"mt-5",onClear:U},{default:t(()=>[a(E,{label:s.$t("customers.display_name"),class:"text-left"},{default:t(()=>[a(S,{modelValue:n(r).display_name,"onUpdate:modelValue":l[1]||(l[1]=e=>n(r).display_name=e),type:"text",name:"name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),a(E,{label:s.$t("customers.contact_name"),class:"text-left"},{default:t(()=>[a(S,{modelValue:n(r).contact_name,"onUpdate:modelValue":l[2]||(l[2]=e=>n(r).contact_name=e),type:"text",name:"address_name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),a(E,{label:s.$t("customers.phone"),class:"text-left"},{default:t(()=>[a(S,{modelValue:n(r).phone,"onUpdate:modelValue":l[3]||(l[3]=e=>n(r).phone=e),type:"text",name:"phone",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),D(a(K,{title:s.$t("customers.no_customers"),description:s.$t("customers.list_of_customers")},{actions:t(()=>[n(g).hasAbilities(n(B).CREATE_CUSTOMER)?(p(),_($,{key:0,variant:"primary-outline",onClick:l[4]||(l[4]=e=>s.$router.push("/admin/customers/create"))},{left:t(e=>[a(c,{name:"PlusIcon",class:b(e.class)},null,8,["class"])]),default:t(()=>[h(" "+d(s.$t("customers.add_new_customer")),1)]),_:1})):T("",!0)]),default:t(()=>[a(_e,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[w,F.value]]),D(i("div",ye,[i("div",he,[n(u).selectedCustomers.length?(p(),_(X,{key:0},{activator:t(()=>[i("span",Be,[h(d(s.$t("general.actions"))+" ",1),a(c,{name:"ChevronDownIcon"})])]),default:t(()=>[a(Q,{onClick:W},{default:t(()=>[a(c,{name:"TrashIcon",class:"mr-3 text-gray-600"}),h(" "+d(s.$t("general.delete")),1)]),_:1})]),_:1})):T("",!0)]),a(ee,{ref_key:"tableComponent",ref:k,class:"mt-3",data:H,columns:Y.value},de({header:t(()=>[i("div",ve,[a(R,{modelValue:M.value,"onUpdate:modelValue":l[5]||(l[5]=e=>M.value=e),variant:"primary",onChange:n(u).selectAllCustomers},null,8,["modelValue","onChange"])])]),"cell-status":t(({row:e})=>[i("div",Ce,[a(R,{id:e.data.id,modelValue:A.value,"onUpdate:modelValue":l[6]||(l[6]=ae=>A.value=ae),value:e.data.id,variant:"primary"},null,8,["id","modelValue","value"])])]),"cell-name":t(({row:e})=>[a(q,{to:{path:`customers/${e.data.id}/view`}},{default:t(()=>[a(N,{text:e.data.name,length:30,tag:"span",class:"font-medium text-primary-500 flex flex-col"},null,8,["text"]),a(N,{text:e.data.contact_name?e.data.contact_name:"",length:30,tag:"span",class:"text-xs text-gray-400"},null,8,["text"])]),_:2},1032,["to"])]),"cell-phone":t(({row:e})=>[i("span",null,d(e.data.phone?e.data.phone:"-"),1)]),"cell-due_amount":t(({row:e})=>[a(Z,{amount:e.data.due_amount||0,currency:e.data.currency},null,8,["amount","currency"])]),"cell-created_at":t(({row:e})=>[i("span",null,d(e.data.formatted_created_at),1)]),_:2},[z()?{name:"cell-actions",fn:t(({row:e})=>[a(pe,{row:e.data,table:n(k),"load-data":I},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"])],512),[[w,!F.value]])]),_:1})}}};export{Ie as default};
